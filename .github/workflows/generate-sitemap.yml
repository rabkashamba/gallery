name: Generate XML Sitemap

on:
  push:
    branches: [ main ] 

jobs:
  sitemap_job:
    runs-on: ubuntu-latest
    name: Generate Sitemap and Commit

    steps:
      - name: Checkout the repository
        uses: actions/checkout@v4
        with:
          # Fetch full history is needed to properly update the sitemap date tags (<lastmod>)
          fetch-depth: 0 

      - name: Generate the sitemap.xml
        uses: cicirello/generate-sitemap@v1
        with:
          # IMPORTANT: REPLACE THIS WITH YOUR FULL GITHUB PAGES URL
          base-url-path: https://rabkashamba.github.io/gallery/

      - name: Commit and push sitemap.xml
        uses: stefanzweifel/git-auto-commit-action@v5
        with:
          commit_message: "ðŸ¤– Auto-generated sitemap.xml"
          file_pattern: sitemap.xml
          # Set the commit author to avoid Git warnings
          commit_user_name: github-actions[bot]
          commit_user_email: github-actions[bot]@users.noreply.github.com
